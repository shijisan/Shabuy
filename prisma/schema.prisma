generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}


model User {
  id          Int      @id @default(autoincrement())
  name        String
  email       String   @unique
  password    String
  roles       UserRole[]
  products    Product[] @relation("ProductSeller")
  orders      Order[]   @relation("UserOrders")
}

model UserRole {
  userId      Int
  role        UserRoleType // Enum directly

  user        User     @relation(fields: [userId], references: [id])

  @@id([userId, role])
}

model Product {
  id          Int      @id @default(autoincrement())
  name        String
  description String
  price       Float
  quantity    Int
  deleted     Boolean  @default(false) // Added field for soft deletion
  mainImage   String?  // URL of the main image
  images      Image[]  // Relation to the Image model
  seller      User     @relation("ProductSeller", fields: [sellerId], references: [id])
  sellerId    Int
  orders      Order[]  @relation("OrderProducts")
}

model Image {
  id        Int      @id @default(autoincrement())
  url       String   // URL of the image
  product   Product  @relation(fields: [productId], references: [id])
  productId Int
}



model Order {
  id         Int      @id @default(autoincrement())
  totalPrice Float
  user       User     @relation("UserOrders", fields: [userId], references: [id])
  userId     Int
  products   Product[] @relation("OrderProducts")
}

enum UserRoleType {
  USER
  SELLER
  ADMIN
}
